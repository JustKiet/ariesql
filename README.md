# ArieSQL: The Modern SQL Agent

## Introduction

ArieSQL is a SQL agent designed to provide secure, efficient, and user-friendly access to databases. It enforces strict access controls, ensuring that users can only interact with data they are authorized to see. With support for multiple database dialects and a focus on security, ArieSQL is the ideal solution for organizations looking to manage their data access effectively.

## Proof-of-Concept Story

SQL Agent has always been this magical and powerful black box that can understand natural language and generate SQL queries. However, the security implications of such a powerful tool have been a major concern. 

To my experience, most SQL agents I come across are too **naive about security**, often granting excessive permissions to the agent or lacking proper access control mechanisms, especially with WRITE operations. This can lead to potential data breaches or unauthorized data manipulation, which is a risk that organizations cannot afford to take.

My thoughts to address this issue were to create a SQL agent that operates under the principle of **least privilege**, ensuring that it only has access to the data and operations necessary for its function. This involves implementing a robust access control system, where users can define specific permissions for the agent, and the agent can only execute queries within those defined parameters. READ operations are the primary focus, while **WRITE operations** *MUST* be concretely defined through **function-calling** instead of free-form SQL generation. My approach in theory can significantly reduce the attack surface and mitigate the risks associated with SQL agents, while still maintaining the powerful and flexible nature of natural language query generation.

ArieSQL was born out of the need to create a SQL agent that not only delivers on its promise of natural language understanding but also prioritizes security and access control. While the project is just a POC at this stage, it lays the groundwork for a more secure and efficient SQL agent that can be further developed and refined in the future.

The core functions of ArieSQL include:
- **Natural Language Query Generation** *(duh)*: ArieSQL can understand user queries in natural language and generate corresponding SQL queries to retrieve data from the database.
- **Strict Access Control & Governance**: Users can define specific permissions for the agent, ensuring that it only has access to the data and operations necessary for its function. This is achieved through a database manifest that outlines the accessible tables, columns, and operations for the agent. In order to even reach to the database, the input query must first pass through a rigorous validation process that checks and guardrails for compliance with the defined access controls and safe-llm usage. This pre-execution validation ensures that any query that violates the access policies is rejected before it can be executed, thereby preventing unauthorized data access or manipulation.
- **Plug-and-Play by Design**: ArieSQL is in vision to be a plug-and-play solution that can be easily integrated with various databases and applications. The architecture is designed to be modular and flexible, allowing for easy customization and extension to support different database dialects and designs.
- **Visualization & User Experience**: ArieSQL includes a visualization component (basically a sandbox environment where the agent can import the data it queried and create charts, tables, or other visual representations to help users better understand the data and insights generated by the agent) to enhance the user experience and make it easier for users to interact with their data. The sandbox environment module is also designed with security in mind, ensuring that any data imported into the sandbox is properly sanitized and that the agent's ability to manipulate data within the sandbox is strictly controlled.

***As of 26/02/2026:*** 

- The current implementation of ArieSQL focuses on **READ operations** and visualizations, with a strong emphasis on security and access control from the pre-execution level (post-execution validation is a roadmap in the future). 
- **WRITE operations** are not yet supported in this POC, but the architecture is designed to accommodate them in the future through a function-calling mechanism that ensures strict control over data manipulation. 
- **Searchable column's values (fuzzy matching)** is also on the roadmap for future development, as it can enhance the agent's ability to understand and generate queries based on user input without having to know all the different variations of column values.
- **Authorization** is also **mocked**, since the main focus of this POC is to demonstrate the secure SQL generation and execution process. In a production implementation, a robust authentication and authorization system would need to be integrated to ensure that only authorized users can access the agent and that their permissions are properly enforced.
- **Output validation** is also not yet implemented in this POC, but it is an important aspect of ensuring that the results returned by the agent do not contain sensitive information or violate any access policies. This will be a key area of focus for future development to further enhance the security and reliability of ArieSQL.

## Application Flow

<image src="images/ariesql_flow.png" alt="ArieSQL Application Flow" width="100%"/>

When a user asks “What are my tickets?”, the system processes it as follows:

### 1. AuthZ (Authorization)

Verify user identity and scope.

Ensure access is limited to their own data.

### 2. Input Validation

Check for prompt injection, poisoning, or malicious input.

If suspicious:

- Return 400 Bad Request

- Log activity to App Insights

If safe:

- Forward sanitized query

### 3. SQL Agent Initialization

Initialize agent with user scope.

Prevent cross-user data access.

### 4. QueryBank Lookup

Perform semantic search for similar past queries.

- If found → reuse known-good SQL.

- If not found → generate new SQL.

### 5. SQL Validation & Execution

Validate query (read-only, scoped, safe).

- If invalid → reject and return safe failure.

- If valid → execute against database.

### 6. Result Validation

Sanitize results.

Ensure no sensitive data leakage.

### 7. Response Generation

Convert structured results into natural language.

Stream response back to user.

## Quick Start

### 1. **Install Dependencies**

#### 1.1. Backend Dependencies (Python, managed by uv)

```
uv sync
```

Fill in the env variables in `.env` file:

```
cp .env.example .env
```

#### 1.2. Frontend Dependencies (Node.js, managed by npm)

```
npm install
```

#### 1.3. Database Manifest

The database manifest is a user-defined access scope declaration in order for the SQL Agent to work securely.
Refer to the `./configs/database_manifest.mssql.example.json` for the JSON structure.
After filling the database manifest, insert its path into the `DATABASE_MANIFEST_PATH` env variable.

Copy the example:

```
cp database_manifest.mssql.example.json database_manifest.mssql.json
```

### 2. **Run the Application**

#### 2.1. Start the Database and Cache Storage (using Docker Compose)

```
docker compose up -d
```

#### 2.2. Start the Backend Server

```
uv run main.py
```

#### 2.3. Start the Frontend Development Server

```
cd frontend && npm run dev
```
